<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CircleAI Settings</title>
  <link rel="stylesheet" type="text/css" href="styles.css">
</head>
<body class="popup-body">
  <div class="container">
    <h1>CircleAI Settings</h1>
    
    <div class="form-group">
      <label for="apiProvider">AI Provider:</label>
      <select id="apiProvider">
        <option value="openai">OpenAI</option>
        <option value="gemini">Google Gemini</option>
        <option value="anthropic">Anthropic Claude</option>
        <option value="grok">Grok (xAI)</option>
        <option value="custom">Custom Provider</option>
      </select>
    </div>

    <!-- OpenAI Settings -->
    <div id="openai-settings" class="settings-section">
      <h2>OpenAI Settings</h2>
      <div class="input-group">
         <label for="openai-key">API Key:</label>
         <div class="input-wrapper">
           <input type="password" id="openai-key" placeholder="sk-...">
           <button type="button" class="toggle-password" data-target="openai-key">👁️‍🗨️</button>
         </div>
       </div>
      <div class="form-group">
        <label for="openai-model">Model:</label>
        <select id="openai-model">
          <option value="gpt-4o">GPT-4o</option>
          <option value="gpt-4o-mini">GPT-4o Mini</option>
          <option value="gpt-4-turbo">GPT-4 Turbo</option>
          <option value="gpt-3.5-turbo">GPT-3.5 Turbo</option>
          <option value="custom">Custom Model</option>
        </select>
      </div>
      <div class="form-group" id="openai-custom-model" style="display: none;">
        <label for="openai-custom-model-input">Custom Model Name:</label>
        <input type="text" id="openai-custom-model-input" placeholder="e.g., gpt-4o-2024-11-20">
      </div>
    </div>

    <!-- Gemini Settings -->
    <div id="gemini-settings" class="settings-section" style="display: none;">
      <h2>Google Gemini Settings</h2>
      <div class="input-group">
         <label for="gemini-key">API Key:</label>
         <div class="input-wrapper">
           <input type="password" id="gemini-key" placeholder="AIza...">
           <button type="button" class="toggle-password" data-target="gemini-key">👁️‍🗨️</button>
         </div>
       </div>
      <div class="form-group">
        <label for="gemini-model">Model:</label>
        <select id="gemini-model">
          <option value="gemini-2.5-pro">Gemini 2.5 Pro</option>
          <option value="gemini-2.5-flash">Gemini 2.5 Flash</option>
          <option value="gemini-2.5-flash-lite-preview-06-17">Gemini 2.5 Flash-Lite</option>
          <option value="gemini-2.0-flash">Gemini 2.0 Flash</option>
          <option value="gemini-2.0-flash-lite">Gemini 2.0 Flash-Lite</option>
          <option value="custom">Custom Model</option>
        </select>
      </div>
      <div class="form-group" id="gemini-custom-model" style="display: none;">
        <label for="gemini-custom-model-input">Custom Model Name:</label>
        <input type="text" id="gemini-custom-model-input" placeholder="e.g., gemini-2.0-flash-thinking-exp">
      </div>
    </div>

    <!-- Anthropic Settings -->
    <div id="anthropic-settings" class="settings-section" style="display: none;">
      <h2>Anthropic Claude Settings</h2>
      <div class="input-group">
         <label for="anthropic-key">API Key:</label>
         <div class="input-wrapper">
           <input type="password" id="anthropic-key" placeholder="sk-ant-...">
           <button type="button" class="toggle-password" data-target="anthropic-key">👁️‍🗨️</button>
         </div>
       </div>
      <div class="form-group">
        <label for="anthropic-model">Model:</label>
        <select id="anthropic-model">
          <option value="claude-3-5-sonnet-20241022">Claude 3.5 Sonnet (Latest)</option>
          <option value="claude-3-5-haiku-20241022">Claude 3.5 Haiku</option>
          <option value="claude-3-opus-20240229">Claude 3 Opus</option>
          <option value="claude-3-sonnet-20240229">Claude 3 Sonnet</option>
          <option value="custom">Custom Model</option>
        </select>
      </div>
      <div class="form-group" id="anthropic-custom-model" style="display: none;">
        <label for="anthropic-custom-model-input">Custom Model Name:</label>
        <input type="text" id="anthropic-custom-model-input" placeholder="e.g., claude-3-5-sonnet-20241022">
      </div>
    </div>

    <!-- Grok Settings -->
    <div id="grok-settings" class="settings-section" style="display: none;">
      <h2>Grok (xAI) Settings</h2>
      <div class="input-group">
         <label for="grok-key">API Key:</label>
         <div class="input-wrapper">
           <input type="password" id="grok-key" placeholder="xai-...">
           <button type="button" class="toggle-password" data-target="grok-key">👁️‍🗨️</button>
         </div>
       </div>
      <div class="form-group">
        <label for="grok-model">Model:</label>
        <select id="grok-model">
          <option value="grok-beta">Grok Beta</option>
          <option value="grok-vision-beta">Grok Vision Beta</option>
          <option value="grok-2-1212">Grok 2 (Latest)</option>
          <option value="grok-2-vision-1212">Grok 2 Vision (Latest)</option>
          <option value="custom">Custom Model</option>
        </select>
      </div>
      <div class="form-group" id="grok-custom-model" style="display: none;">
        <label for="grok-custom-model-input">Custom Model Name:</label>
        <input type="text" id="grok-custom-model-input" placeholder="e.g., grok-2-1212">
      </div>
    </div>

    <!-- Custom Settings -->
    <div id="custom-settings" class="settings-section" style="display: none;">
      <h2>Custom Provider Settings</h2>
      <div class="form-group">
        <label for="custom-url-select">API Base URL:</label>
        <select id="custom-url-select">
          <option value="custom">Custom URL</option>
          <option value="http://localhost:11434/v1">Ollama (Local)</option>
          <option value="https://api.openai.com/v1">OpenAI API</option>
          <option value="http://localhost:1234/v1">LM Studio (Local)</option>
          <option value="http://localhost:8080/v1">Text Generation WebUI</option>
        </select>
      </div>
      <div class="form-group" id="custom-url-input">
        <label for="custom-url">Custom API URL:</label>
        <input type="text" id="custom-url" placeholder="https://api.example.com/v1">
      </div>
      <div class="input-group">
         <label for="custom-key">API Key:</label>
         <div class="input-wrapper">
           <input type="password" id="custom-key" placeholder="Your API Key">
           <button type="button" class="toggle-password" data-target="custom-key">👁️‍🗨️</button>
         </div>
       </div>
      <div class="form-group">
        <label for="custom-model">Model Name:</label>
        <input type="text" id="custom-model" placeholder="model-name">
      </div>
      <div class="checkbox-container">
        <input type="checkbox" id="custom-openai-compatible">
        <label for="custom-openai-compatible">OpenAI Compatible API</label>
      </div>
      <div class="info-box" id="custom-url-info">
        <div class="info-content">
          <strong>📝 自動路徑補全提示：</strong>
          <div id="url-completion-hint">
            <span id="openai-hint" style="display: none;">✅ OpenAI 兼容模式：系統會自動在 URL 後添加 <code>/v1/chat/completions</code></span>
            <span id="generic-hint" style="display: none;">✅ 通用模式：系統會自動在 URL 後添加 <code>/v1/completions</code></span>
          </div>
          <small>💡 您只需要提供基礎 URL（如：https://api.example.com），系統會自動補全完整的 API 端點路徑。</small>
        </div>
      </div>
    </div>

    <!-- Advanced Settings -->
    <div class="advanced-settings">
      <h3>Advanced Settings</h3>
      <div class="advanced-settings-content">
        <div class="slider-container">
          <label for="temperature">Temperature:</label>
          <input type="range" id="temperature" min="0" max="1" step="0.1" value="0.7">
          <span id="temperature-value" class="slider-value">0.7</span>
        </div>
        <div class="form-group">
          <label for="max-tokens">Max Tokens:</label>
          <input type="number" id="max-tokens" min="1" max="4096" value="1000">
        </div>
      </div>
    </div>

    <div class="button-group">
      <button id="test-connection">Test Connection</button>
      <button id="save">Save Settings</button>
    </div>
    
    <div id="status"></div>
  </div>

  <script src="popup.js"></script>
</body>
</html>